<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{fragments/head :: head('Detalle Producto')}"></head>

<body class="hold-transition sidebar-mini">
    <div class="wrapper">
        <nav th:replace="~{fragments/navbar :: navbar}"></nav>
        <aside th:replace="~{fragments/sidebar :: sidebar}"></aside>

        <div class="content-wrapper">
            <div class="content-header">
                <div class="container-fluid">
                    <div class="row mb-2">
                        <div class="col-sm-6">
                            <h1 class="m-0">
                                <i class="fas fa-gamepad neon-icon"></i>
                                <span class="neon-text">DETALLE</span> PRODUCTO
                            </h1>
                        </div>
                        <div class="col-sm-6">
                            <ol class="breadcrumb float-sm-right">
                                <li class="breadcrumb-item"><a th:href="@{/admin/dashboard}">Dashboard</a></li>
                                <li class="breadcrumb-item"><a th:href="@{/admin/productos}">Productos</a></li>
                                <li class="breadcrumb-item active">Detalle</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>

            <section class="content">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-md-5">
                            <div class="card gamer-card">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        <i class="fas fa-images mr-1"></i> Galería de Imágenes
                                    </h3>
                                </div>
                                <div class="card-body">
                                    <div class="text-center mb-3">
                                        >
                                        <img th:if="${producto.imagenPrincipal != null}"
                                            th:src="@{/uploads/productos/{filename}(filename=${producto.imagenPrincipal.url})}"
                                            class="img-fluid rounded" id="imagen-principal" style="max-height: 400px;">
                                        <img th:unless="${producto.imagenPrincipal != null}"
                                            th:src="@{/img/placeholder-game.jpg}" class="img-fluid rounded"
                                            style="max-height: 400px;">
                                    </div>

                                    <div class="row"
                                        th:if="${producto.imagenes != null and !producto.imagenes.isEmpty()}">
                                        <div class="col-3 mb-2" th:each="img : ${producto.imagenes}">
                                            >
                                            <img th:src="@{/uploads/productos/{filename}(filename=${img.url})}"
                                                class="img-thumbnail" onclick="cambiarImagen(this.src)"
                                                style="cursor: pointer;">
                                        </div>
                                    </div>

                                </div>
                            </div>

                            <div class="card gamer-card">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        <i class="fas fa-bolt mr-1"></i> Acciones Rápidas
                                    </h3>
                                </div>
                                <div class="card-body">
                                    <a th:href="@{/admin/productos/editar/{id}(id=${producto.id})}"
                                        class="btn btn-primary btn-block">
                                        <i class="fas fa-edit"></i> Editar Producto
                                    </a>
                                    <a th:href="@{/admin/inventario/registrar-entrada}"
                                        class="btn btn-success btn-block">
                                        <i class="fas fa-plus"></i> Registrar Entrada
                                    </a>
                                    <a th:href="@{/admin/inventario/registrar-salida}"
                                        class="btn btn-warning btn-block">
                                        <i class="fas fa-minus"></i> Registrar Salida
                                    </a>
                                    <a th:href="@{/admin/productos}" class="btn btn-secondary btn-block">
                                        <i class="fas fa-arrow-left"></i> Volver al Listado
                                    </a>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-7">
                            <div class="card gamer-card">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        <i class="fas fa-info-circle mr-1"></i> Información General
                                    </h3>
                                    <div class="card-tools">
                                        <span class="badge"
                                            th:classappend="${producto.activo} ? 'badge-success' : 'badge-secondary'">
                                            <i class="fas"
                                                th:classappend="${producto.activo} ? 'fa-check' : 'fa-times'"></i>
                                            <span th:text="${producto.activo} ? 'ACTIVO' : 'INACTIVO'">ACTIVO</span>
                                        </span>
                                        <span class="badge badge-warning ml-1" th:if="${producto.esDestacado}">
                                            <i class="fas fa-star"></i> DESTACADO
                                        </span>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <h2 th:text="${producto.nombre}">Nombre del Producto</h2>
                                    <p class="text-muted" th:text="${producto.descripcion}">Descripción del
                                        producto...</p>

                                    <hr>

                                    <div class="row">
                                        <div class="col-sm-6">
                                            <strong><i class="fas fa-barcode mr-1"></i> SKU</strong>
                                            <p class="text-muted" th:text="${producto.codigoSku}">SKU-001</p>
                                        </div>
                                        <div class="col-sm-6">
                                            <strong><i class="fas fa-folder mr-1"></i> Categoría</strong>
                                            <p class="text-muted" th:text="${producto.categoria.nombre}">Categoría
                                            </p>
                                        </div>
                                        <div class="col-sm-6">
                                            <strong><i class="fas fa-tag mr-1"></i> Marca</strong>
                                            <p class="text-muted"
                                                th:text="${producto.marca != null ? producto.marca.nombre : '-'}">Marca
                                            </p>
                                        </div>
                                        <div class="col-sm-6">
                                            <strong><i class="fas fa-calendar mr-1"></i> Fecha Creación</strong>
                                            <p class="text-muted"
                                                th:text="${#temporals.format(producto.fechaCreacion, 'dd/MM/yyyy HH:mm')}">
                                                01/01/2024 10:00
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="card gamer-card">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        <i class="fas fa-dollar-sign mr-1"></i> Información de Precios
                                    </h3>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-sm-6">
                                            <div class="info-box bg-light">
                                                <span class="info-box-icon bg-info"><i class="fas fa-tag"></i></span>
                                                <div class="info-box-content">
                                                    <span class="info-box-text">Precio Base</span>
                                                    <span class="info-box-number">
                                                        S/ <span
                                                            th:text="${#numbers.formatDecimal(producto.precioBase, 1, 'POINT', 2, 'POINT')}">0.00</span>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-sm-6">
                                            <div class="info-box bg-light">
                                                <span class="info-box-icon"
                                                    th:classappend="${producto.tieneOferta()} ? 'bg-success' : 'bg-secondary'">
                                                    <i class="fas fa-percent"></i>
                                                </span>
                                                <div class="info-box-content">
                                                    <span class="info-box-text">Precio Oferta</span>
                                                    <span class="info-box-number" th:if="${producto.tieneOferta()}">
                                                        S/ <span
                                                            th:text="${#numbers.formatDecimal(producto.precioOferta, 1, 'POINT', 2, 'POINT')}">0.00</span>
                                                    </span>
                                                    <span class="info-box-number text-muted"
                                                        th:unless="${producto.tieneOferta()}">
                                                        Sin oferta
                                                    </span>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-sm-12" th:if="${producto.tieneOferta()}">
                                            <div class="callout callout-success">
                                                <h5><i class="fas fa-fire"></i> ¡Producto en Oferta!</h5>
                                                <p>Descuento:
                                                    <strong
                                                        th:text="${#numbers.formatDecimal((producto.precioBase - producto.precioOferta) / producto.precioBase * 100, 1, 'POINT', 0, 'POINT')}">0</strong>%
                                                </p>
                                                <p class="mb-0">
                                                    Ahorro:
                                                    <strong>S/ <span
                                                            th:text="${#numbers.formatDecimal(producto.precioBase - producto.precioOferta, 1, 'POINT', 2, 'POINT')}">0.00</span></strong>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="card gamer-card">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        <i class="fas fa-boxes mr-1"></i> Inventario
                                    </h3>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-sm-6">
                                            <div class="info-box">
                                                <span class="info-box-icon"
                                                    th:classappend="${producto.stockActual <= 0} ? 'bg-danger' :
                                                (${producto.stockActual <= producto.stockMinimo} ? 'bg-warning' : 'bg-success')}">
                                                    <i class="fas fa-cubes"></i>
                                                </span>
                                                <div class="info-box-content">
                                                    <span class="info-box-text">Stock Actual</span>
                                                    <span class="info-box-number"
                                                        th:text="${producto.stockActual}">0</span>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-sm-6">
                                            <div class="info-box bg-light">
                                                <span class="info-box-icon bg-info"><i class="fas fa-box"></i></span>
                                                <div class="info-box-content">
                                                    <span class="info-box-text">Stock Mínimo</span>
                                                    <span class="info-box-number"
                                                        th:text="${producto.stockMinimo}">10</span>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-sm-12"
                                            th:if="${producto.stockActual <= producto.stockMinimo and producto.stockActual > 0}">
                                            <div class="callout callout-warning">
                                                <h5><i class="fas fa-exclamation-triangle"></i> Stock Bajo</h5>
                                                <p class="mb-0">El stock actual está por debajo del mínimo
                                                    recomendado. Considera realizar un pedido a proveedores.</p>
                                            </div>
                                        </div>

                                        <div class="col-sm-12" th:if="${producto.stockActual <= 0}">
                                            <div class="callout callout-danger">
                                                <h5><i class="fas fa-times-circle"></i> Sin Stock</h5>
                                                <p class="mb-0">El producto no tiene stock disponible. Los clientes
                                                    no podrán comprarlo hasta que registres una entrada.</p>
                                            </div>
                                        </div>

                                        <div class="col-sm-12" th:if="${producto.stockActual > producto.stockMinimo}">
                                            <div class="callout callout-success">
                                                <h5><i class="fas fa-check-circle"></i> Stock Saludable</h5>
                                                <p class="mb-0">El nivel de stock es adecuado para las ventas.</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
        <footer th:replace="~{fragments/footer :: footer}"></footer>
    </div>
    <div th:replace="~{fragments/scripts :: scripts}"></div>
    <script> function cambiarImagen(src) { document.getElementById('imagen-principal').src = src; } </script>
</body>

</html>