<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{fragments/head :: head('Dashboard')}"></head>

<body class="hold-transition sidebar-mini layout-fixed">
    <div class="wrapper">

        <!-- Navbar -->
        <nav th:replace="~{fragments/navbar :: navbar}"></nav>

        <!-- Sidebar -->
        <aside th:replace="~{fragments/sidebar :: sidebar}"></aside>

        <!-- Content Wrapper -->
        <div class="content-wrapper">
            <!-- Content Header -->
            <div class="content-header">
                <div class="container-fluid">
                    <div class="row mb-2">
                        <div class="col-sm-6">
                            <h1 class="m-0">
                                <i class="fas fa-tachometer-alt neon-icon"></i>
                                <span class="neon-text">DASHBOARD</span> GAMER
                            </h1>
                        </div>
                        <div class="col-sm-6">
                            <ol class="breadcrumb float-sm-right">
                                <li class="breadcrumb-item"><a th:href="@{/admin/dashboard}">Home</a></li>
                                <li class="breadcrumb-item active">Dashboard</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main content -->
            <section class="content">
                <div class="container-fluid">

                    <!-- Estadísticas principales -->
                    <div class="row">
                        <div class="col-lg-3 col-6">
                            <div class="small-box gamer-card">
                                <div class="inner">
                                    <h3
                                        th:text="${'S/ ' + #numbers.formatDecimal(ventasDelDia ?: 0, 1, 'POINT', 2, 'POINT')}">
                                        S/ 0.00</h3>
                                    <p>Ventas del Día</p>
                                </div>
                                <div class="icon"><i class="fas fa-cash-register"></i></div>
                                <a th:href="@{/admin/ventas}" class="small-box-footer gamer-link">Ver Ventas <i
                                        class="fas fa-arrow-circle-right"></i></a>
                            </div>
                        </div>

                        <div class="col-lg-3 col-6">
                            <div class="small-box gamer-card bg-warning">
                                <div class="inner">
                                    <h3 th:text="${pedidosPendientes ?: 0}">0</h3>
                                    <p>Pedidos Pendientes</p>
                                </div>
                                <div class="icon"><i class="fas fa-shopping-cart"></i></div>
                                <a th:href="@{/admin/pedidos}" class="small-box-footer">Ver Pedidos <i
                                        class="fas fa-arrow-circle-right"></i></a>
                            </div>
                        </div>

                        <div class="col-lg-3 col-6">
                            <div class="small-box gamer-card bg-success">
                                <div class="inner">
                                    <h3 th:text="${totalProductos ?: 0}">0</h3>
                                    <p>Productos en Stock</p>
                                </div>
                                <div class="icon"><i class="fas fa-gamepad"></i></div>
                                <a th:href="@{/admin/productos}" class="small-box-footer">Ver Productos <i
                                        class="fas fa-arrow-circle-right"></i></a>
                            </div>
                        </div>

                        <div class="col-lg-3 col-6">
                            <div class="small-box gamer-card bg-danger">
                                <div class="inner">
                                    <h3 th:text="${totalClientes ?: 0}">0</h3>
                                    <p>Clientes Registrados</p>
                                </div>
                                <div class="icon"><i class="fas fa-users"></i></div>
                                <a th:href="@{/admin/clientes}" class="small-box-footer">Ver Clientes <i
                                        class="fas fa-arrow-circle-right"></i></a>
                            </div>
                        </div>
                    </div>

                    <!-- Alertas-->
                    <div class="row">
                        <div class="col-lg-3 col-6" th:if="${productosStockBajo > 0}">
                            <div class="small-box bg-warning">
                                <div class="inner">
                                    <h3 th:text="${productosStockBajo}">0</h3>
                                    <p>Productos con Stock Bajo</p>
                                </div>
                                <div class="icon"><i class="fas fa-exclamation-triangle"></i></div>
                                <a th:href="@{/admin/inventario/alertas}" class="small-box-footer">Ver Alertas <i
                                        class="fas fa-arrow-circle-right"></i></a>
                            </div>
                        </div>

                        <div class="col-lg-3 col-6">
                            <div class="small-box bg-info">
                                <div class="inner">
                                    <h3 th:text="${creditosActivos ?: 0}">0</h3>
                                    <p>Créditos Activos</p>
                                </div>
                                <div class="icon"><i class="fas fa-credit-card"></i></div>
                                <a th:href="@{/admin/creditos}" class="small-box-footer">Ver Créditos <i
                                        class="fas fa-arrow-circle-right"></i></a>
                            </div>
                        </div>

                        <div class="col-lg-3 col-6">
                            <div class="small-box bg-purple">
                                <div class="inner">
                                    <h3
                                        th:text="${'S/ ' + #numbers.formatDecimal(deudaTotal ?: 0, 1, 'POINT', 2, 'POINT')}">
                                        S/ 0.00</h3>
                                    <p>Deuda Pendiente Total</p>
                                </div>
                                <div class="icon"><i class="fas fa-coins"></i></div>
                                <a th:href="@{/admin/creditos}" class="small-box-footer">Ver Detalle <i
                                        class="fas fa-arrow-circle-right"></i></a>
                            </div>
                        </div>

                        <div class="col-lg-3 col-6" th:if="${cuotasVencidas > 0}">
                            <div class="small-box bg-danger">
                                <div class="inner">
                                    <h3 th:text="${cuotasVencidas}">0</h3>
                                    <p>Cuotas Vencidas</p>
                                </div>
                                <div class="icon"><i class="fas fa-exclamation-circle"></i></div>
                                <a th:href="@{/admin/creditos/cuotas-vencidas}" class="small-box-footer">Ver Vencidas <i
                                        class="fas fa-arrow-circle-right"></i></a>
                            </div>
                        </div>
                    </div>

                    <!-- Gráficas y tablas -->
                    <div class="row">
                        <div class="col-lg-6">
                            <div class="card gamer-card">
                                <div class="card-header border-0">
                                    <h3 class="card-title">
                                        <i class="fas fa-chart-line neon-icon mr-1"></i> Últimas Ventas del Día
                                    </h3>
                                </div>
                                <div class="card-body table-responsive p-0">
                                    <table class="table table-striped table-valign-middle">
                                        <thead>
                                            <tr>
                                                <th>Nº Venta</th>
                                                <th>Cliente</th>
                                                <th>Total</th>
                                                <th>Tipo</th>
                                                <th>Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr th:if="${#lists.isEmpty(ultimasVentas)}">
                                                <td colspan="5" class="text-center">
                                                    <i class="fas fa-inbox fa-3x text-muted mb-3"></i>
                                                    <p class="text-muted">No hay ventas registradas hoy</p>
                                                </td>
                                            </tr>
                                            <tr th:each="venta : ${ultimasVentas}">
                                                <td><span class="badge badge-primary"
                                                        th:text="${venta.numeroVenta}">VEN-001</span></td>
                                                <td th:text="${venta.cliente.nombreCompleto}">Cliente</td>
                                                <td><span class="text-success font-weight-bold"
                                                        th:text="${'S/ ' + #numbers.formatDecimal(venta.total, 1, 'POINT', 2, 'POINT')}">S/
                                                        0.00</span></td>
                                                <td>
                                                    <span
                                                        th:classappend="${venta.tipoPago.name() == 'CONTADO'} ? 'badge-success' : 'badge-warning'"
                                                        class="badge" th:text="${venta.tipoPago.nombre}">CONTADO</span>
                                                </td>
                                                <td>
                                                    <a th:href="@{/admin/ventas/ver/{id}(id=${venta.id})}"
                                                        class="btn btn-sm btn-primary">
                                                        <i class="fas fa-eye"></i>
                                                    </a>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-6">
                            <div class="card gamer-card">
                                <div class="card-header border-0">
                                    <h3 class="card-title">
                                        <i class="fas fa-shopping-cart neon-icon mr-1"></i> Pedidos Pendientes
                                    </h3>
                                </div>
                                <div class="card-body table-responsive p-0">
                                    <table class="table table-striped table-valign-middle">
                                        <thead>
                                            <tr>
                                                <th>Nº Pedido</th>
                                                <th>Cliente</th>
                                                <th>Total</th>
                                                <th>Estado</th>
                                                <th>Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr th:if="${#lists.isEmpty(ultimosPedidos)}">
                                                <td colspan="5" class="text-center">
                                                    <i class="fas fa-check-circle fa-3x text-success mb-3"></i>
                                                    <p class="text-muted">No hay pedidos pendientes</p>
                                                </td>
                                            </tr>
                                            <tr th:each="pedido : ${ultimosPedidos}">
                                                <td><span class="badge badge-info"
                                                        th:text="${pedido.numeroPedido}">PED-001</span></td>
                                                <td th:text="${pedido.cliente.nombreCompleto}">Cliente</td>
                                                <td><span class="text-primary font-weight-bold"
                                                        th:text="${'S/ ' + #numbers.formatDecimal(pedido.total, 1, 'POINT', 2, 'POINT')}">S/
                                                        0.00</span></td>
                                                <td><span class="badge badge-warning"
                                                        th:text="${pedido.estado.nombre}">PENDIENTE</span></td>
                                                <td>
                                                    <a th:href="@{/admin/pedidos/ver/{id}(id=${pedido.id})}"
                                                        class="btn btn-sm btn-primary">
                                                        <i class="fas fa-eye"></i>
                                                    </a>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Productos con stock bajo -->
                    <div class="row" th:if="${not #lists.isEmpty(productosAlerta)}">
                        <div class="col-12">
                            <div class="card gamer-card">
                                <div class="card-header border-0">
                                    <h3 class="card-title">
                                        <i class="fas fa-exclamation-triangle text-warning neon-icon mr-1"></i> Alertas
                                        de Stock Bajo
                                    </h3>
                                    <div class="card-tools">
                                        <a th:href="@{/admin/inventario/alertas}" class="btn btn-sm btn-warning">Ver
                                            Todas</a>
                                    </div>
                                </div>
                                <div class="card-body table-responsive p-0">
                                    <table class="table table-striped">
                                        <thead>
                                            <tr>
                                                <th>Producto</th>
                                                <th>SKU</th>
                                                <th>Categoría</th>
                                                <th>Stock Actual</th>
                                                <th>Stock Mínimo</th>
                                                <th>Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr th:each="producto : ${productosAlerta}">
                                                <td>
                                                    <img th:if="${producto.imagenPrincipal != null}"
                                                        th:src="@{'/uploads' + ${producto.imagenPrincipal.url}}"
                                                        class="img-thumbnail mr-2" style="max-width: 40px;">
                                                    <span th:text="${producto.nombre}">Producto</span>
                                                </td>
                                                <td><span class="badge badge-secondary"
                                                        th:text="${producto.codigoSku}">SKU-001</span></td>
                                                <td th:text="${producto.categoria.nombre}">Categoría</td>
                                                <td><span class="badge badge-danger"
                                                        th:text="${producto.stockActual}">0</span></td>
                                                <td><span class="badge badge-info"
                                                        th:text="${producto.stockMinimo}">10</span></td>
                                                <td>
                                                    <a th:href="@{/admin/inventario/registrar-entrada}"
                                                        class="btn btn-sm btn-success">
                                                        <i class="fas fa-plus"></i> Registrar Entrada
                                                    </a>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </section>
        </div>

        <!-- Footer -->
        <footer th:replace="~{fragments/footer :: footer}"></footer>
    </div>

    <!-- Scripts -->
    <div th:replace="~{fragments/scripts :: scripts}"></div>

</body>

</html>